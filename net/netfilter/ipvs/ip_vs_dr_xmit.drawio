<mxfile host="17fb1adb-8908-43f5-9870-c890a810f39a" modified="2020-07-30T09:56:03.256Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Code/1.47.0 Chrome/78.0.3904.130 Electron/7.3.2 Safari/537.36" etag="OnVUseJPhZT69AfVfqPU" version="13.1.3">
    <diagram id="6hGFLwfOUW9BJ-s0fimq" name="Page-1">
        <mxGraphModel dx="1172" dy="785" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="2" target="3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="ip_vs_send_or_cont" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="4">
                    <mxGeometry x="-0.0462" y="-1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="2" target="6">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="8" value="__ip_vs_get_out_rt" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="7">
                    <mxGeometry x="-0.8702" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="2" value="&lt;div style=&quot;color: rgb(171 , 178 , 191) ; background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_vs_dr_xmit&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;sk_buff&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_conn&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_protocol&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;pp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_iphdr&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ipvsh&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; rcu_read_lock&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;__ip_vs_get_out_rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ip&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;IP_VS_RT_MODE_LOCAL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;|&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;IP_VS_RT_MODE_NON_LOCAL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;|&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;IP_VS_RT_MODE_KNOWN_NH&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; tx_error;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_vs_send_or_cont&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;NFPROTO_IPV4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; ip_send_check&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_hdr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;));&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; /* Another hack: avoid icmp_send in ip_fragment */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ignore_df&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; ip_vs_send_or_cont&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;NFPROTO_IPV4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NF_STOLEN&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;}&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="120" y="80" width="530" height="520" as="geometry"/>
                </mxCell>
                <mxCell id="3" value="&lt;div style=&quot;color: rgb(171 , 178 , 191) ; background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;static&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;inline&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_vs_send_or_cont&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;pf&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;sk_buff&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_conn&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ret&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NF_STOLEN&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ipvs_property&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;likely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;cp&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;flags&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;IP_VS_CONN_F_NFCT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ip_vs_notrack&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ip_vs_drop_early_demux_sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; skb_forward_csum&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; NF_HOOK&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;pf&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;NF_INET_LOCAL_OUT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;skb_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dev&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;dst_output_sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ret&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NF_ACCEPT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ret&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="107.5" y="720" width="555" height="330" as="geometry"/>
                </mxCell>
                <mxCell id="10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;" edge="1" parent="1" source="6" target="9">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="6" target="12">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="15" value="do_ooutput_route4" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="14">
                    <mxGeometry x="0.0364" y="-1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="6" value="&lt;div style=&quot;background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;static&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #61afef&quot;&gt;__ip_vs_get_out_rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;sk_buff&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_dest&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;__be32&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;__be32&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ret_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;dev_net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;skb_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dev&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;netns_ipvs&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ipvs&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;net_ipvs&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;          &lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;/* Route to the other host */&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;         &lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;/* Original route */&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;iphdr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; __be16&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;df&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;noref&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;__ip_vs_dst_check&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;likely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst_cache&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_vs_dest_dst_alloc&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;();&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; __ip_vs_dst_set&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_unreach;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;do_output_route4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;addr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ip&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: rgb(198 , 120 , 221)&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;dest_dst&lt;/span&gt;-&amp;gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;dst_saddr&lt;/span&gt;.&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;ip&lt;/span&gt;);&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; __ip_vs_dst_set&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ip_vs_dest_dst_free&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_unreach;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; __ip_vs_dst_set&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;dest&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;addr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ip&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ret_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ret_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ip&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; __be32&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;htonl&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;INADDR_ANY&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; noref&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;~&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_CONNECT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;do_output_route4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_unreach;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ret_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;ret_saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_flags&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; RTCF_LOCAL) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;?&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;iph&lt;/span&gt; &lt;span style=&quot;color: rgb(198 , 120 , 221)&quot;&gt;=&lt;/span&gt; &lt;span style=&quot;color: rgb(97 , 175 , 239)&quot;&gt;ip_hdr&lt;/span&gt;&lt;font color=&quot;#abb2bf&quot;&gt;(&lt;/font&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117) ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;font color=&quot;#abb2bf&quot;&gt;);&lt;/font&gt;&lt;br&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;likely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;unlikely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ipv4_is_loopback&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;))) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IP_VS_DBG_RL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;Stopping traffic from loopback address &quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;&lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%p&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;I4 to non-local address, dest: &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%p&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;I4&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_put;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;skb_rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_RDR&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; !&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_flags&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; RTCF_LOCAL)) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IP_VS_DBG_RL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;Redirect from non-local address &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%p&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;I4 to &quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&quot;local requires NAT method, dest: &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%p&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;I4&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_put;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* skb to local stack, preserve old route */&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;noref&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ip_rt_put&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; }&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;likely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_TUNNEL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;))) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;dst_mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; df&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;frag_off&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;htons&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;IP_DF&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;sock&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;dst_mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;sizeof&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;iphdr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;68&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IP_VS_DBG_RL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%s&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;(): mtu less than 68&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, __func__);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_put;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;skb_rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dev&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;sk_fullsock&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ops&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;update_pmtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ort&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;sk&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* MTU check allowed? */&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; df&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;sysctl_pmtu_disc&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;ipvs&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;?&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;frag_off&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;htons&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;IP_DF&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; /* MTU checking */&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;unlikely&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;df&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;len&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;skb_is_gso&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;))) {&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; icmp_send&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ICMP_DEST_UNREACH&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ICMP_FRAG_NEEDED&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;htonl&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;mtu&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;));&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IP_VS_DBG&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;frag needed for &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;%p&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;I4&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #98c379&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;iph&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; err_put;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; skb_dst_drop&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;noref&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(198 , 120 , 221)&quot;&gt;if&lt;/span&gt;&lt;font color=&quot;#abb2bf&quot; style=&quot;color: rgb(171 , 178 , 191)&quot;&gt; (&lt;/font&gt;&lt;span style=&quot;color: rgb(86 , 182 , 194)&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;local&lt;/span&gt;&lt;font color=&quot;#abb2bf&quot; style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;color: rgb(97 , 175 , 239)&quot;&gt;skb_dst_set_noref&lt;/span&gt;&lt;span style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117) ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: rgb(198 , 120 , 221)&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; else&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; skb_dst_set&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;dst_clone&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;));&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;skb_dst_set&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;skb&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;local&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(171 , 178 , 191)&quot;&gt;}&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="960" y="60" width="700" height="2190" as="geometry"/>
                </mxCell>
                <mxCell id="9" value="&lt;div style=&quot;color: rgb(171 , 178 , 191) ; background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;static&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;inline&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_vs_dest_dst_alloc&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;void&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;kmalloc&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;sizeof&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;ip_vs_dest_dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;), &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;GFP_ATOMIC&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="1820" y="160" width="500" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="11" value="ip_vs_dest_dst_alloc" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;" vertex="1" parent="1">
                    <mxGeometry x="1702" y="359" width="130" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="&lt;div style=&quot;color: rgb(171 , 178 , 191) ; background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;static&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;do_output_route4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;__be32&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;                       &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;__be32&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;flowi4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;loop&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; memset&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;sizeof&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;));&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_CONNECT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;?&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;flowi4_flags&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_KNOWN_NH&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;?&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; FLOWI_FLAG_KNOWN_NH&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;retry:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;ip_route_output_key&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;net&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;IS_ERR&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;)) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; /* Invalid saddr ? */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;PTR_ERR&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;EINVAL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_CONNECT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;loop&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; flowi4_update_output&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; retry;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; } &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; (&lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;!&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;rt_mode&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;IP_VS_RT_MODE_CONNECT&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #56b6c2&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;) {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; ip_rt_put&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; *&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #61afef&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; flowi4_update_output&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #d19a66&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;daddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;);&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; loop&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;++&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; goto&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; retry;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; *&lt;/span&gt;&lt;span style=&quot;color: #e06c75 ; font-style: italic&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;fl4&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;saddr&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; return&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="1830" y="430" width="580" height="690" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="&lt;div style=&quot;color: rgb(171 , 178 , 191) ; background-color: rgb(40 , 44 , 52) ; font-family: &amp;#34;monaco&amp;#34; , &amp;#34;menlo&amp;#34; , &amp;#34;monaco&amp;#34; , &amp;#34;courier new&amp;#34; , monospace ; font-weight: normal ; font-size: 13px ; line-height: 20px&quot;&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;rtable&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;dst_entry&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;dst&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_genid&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; unsigned&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_flags&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; __u16&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_type&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; __u8&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_is_input&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; __u8&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_uses_gateway&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #c678dd&quot;&gt;&amp;nbsp; &amp;nbsp; int&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_iif&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #7f848e ; font-style: italic&quot;&gt;&amp;nbsp; &amp;nbsp; /* Info on neighbour */&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;&lt;/span&gt;&lt;span style=&quot;color: #e5c07b&quot;&gt;&amp;nbsp; &amp;nbsp; __be32&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e06c75&quot;&gt;rt_gateway&lt;/span&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(198 , 120 , 221)&quot;&gt;&amp;nbsp; &amp;nbsp; struct&lt;/span&gt; &lt;span style=&quot;color: rgb(229 , 192 , 123)&quot;&gt;list_head&lt;/span&gt; &lt;span style=&quot;color: rgb(224 , 108 , 117)&quot;&gt;rt_uncached&lt;/span&gt;;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #abb2bf&quot;&gt;};&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
                    <mxGeometry x="2500" y="290" width="260" height="270" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>